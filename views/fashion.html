<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fashion Picks - FitsnFoods</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    .masonry {
      column-count: 1;
    }
    @media (min-width: 640px) {
      .masonry { column-count: 2; }
    }
    @media (min-width: 768px) {
      .masonry { column-count: 3; }
    }
    @media (min-width: 1024px) {
      .masonry { column-count: 4; }
    }

    .masonry-item {
      break-inside: avoid;
      margin-bottom: 1rem;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .masonry-item:hover {
      transform: scale(1.03);
      box-shadow: 0 8px 20px rgba(255, 182, 193, 0.4);
    }

    img {
      width: 100%;
      border-radius: 12px 12px 0 0;
      display: block;
    }
  </style>
</head>
<body class="bg-pink-50 font-sans text-gray-800">

  <header class="relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-b from-pink-200/80 via-pink-100/70 to-pink-50 pointer-events-none"></div>
    <div class="relative bg-cover bg-center" style="background-image: url('/images/fashion-girl.jpg');">
      <div class="backdrop-filter backdrop-blur-sm bg-white/40">
        <div class="max-w-6xl mx-auto px-6 py-16 text-center">
          <h1 class="text-4xl md:text-5xl font-extrabold text-pink-700">üëó Fashion Gallery</h1>
          <p class="text-base md:text-lg text-pink-700 mt-2">Inspiration for college days, dates, brunches, parties & more ‚ú®</p>
          <div class="mt-5 flex flex-col sm:flex-row gap-3 justify-center">
            <a href="/" class="px-4 py-2 text-sm font-semibold text-white bg-pink-500 rounded-full hover:bg-pink-600 transition duration-300">üè† Back to Home</a>
            <button id="openUpload" class="px-4 py-2 text-sm font-semibold text-white bg-pink-600 rounded-full hover:bg-pink-700 transition duration-300">üì∏ Share Your Look</button>
            <a href="#gallery" class="px-4 py-2 text-sm font-semibold text-pink-600 bg-white rounded-full hover:bg-pink-50 border border-pink-200 transition duration-300">Browse Looks ‚Üì</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Filters & Search -->
    <div class="sticky top-0 z-10 bg-pink-50/90 backdrop-filter backdrop-blur-md border-b border-pink-100">
      <div class="max-w-6xl mx-auto px-6 py-4 flex flex-col md:flex-row gap-3 md:items-center md:justify-between">
        <div class="flex flex-wrap gap-2" id="filterBar">
          <button class="px-3 py-1.5 text-sm rounded-full bg-pink-600 text-white" data-filter="all">All</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="date">Date Night</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="college">College</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="festive">Festive</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="street">Street</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="brunch">Brunch</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="party">Party</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="summer">Summer</button>
          <button class="px-3 py-1.5 text-sm rounded-full bg-white text-pink-600 border border-pink-200 hover:bg-pink-50" data-filter="casual">Casual</button>
        </div>
        <div class="flex-1 md:flex-none">
          <label class="relative block">
            <span class="sr-only">Search looks</span>
            <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-pink-500">üîé</span>
            <input id="searchInput" type="text" placeholder="Search looks..." class="w-full md:w-64 pl-10 pr-3 py-2 rounded-lg border border-pink-200 focus:outline-none focus:ring-2 focus:ring-pink-300 bg-white placeholder-pink-300"/>
          </label>
        </div>
      </div>
    </div>
  </header>

  <!-- Masonry Pinterest Grid -->
  <main id="gallery" class="p-6 masonry">
    
    <!-- Repeat this block for each outfit -->
    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="date">
      <img src="/images/datenightdress.jpg" alt="Date Night Dress" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Date Night Dress</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Date</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Elegant & flirty üíï</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="college">
      <img src="/images/collegedress.jpg" alt="College Look" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">College Look</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">College</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Trendy and comfy üå∏</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="festive">
      <img src="/images/traditinaldress.jpg" alt="Festive Fit" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Festive Fit</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Festive</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Traditional with glam ‚ú®</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="street">
      <img src="/images/streetstyledress.jpg" alt="Street Style" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Street Style</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Street</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Cool girl vibes üòé</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="brunch">
      <img src="/images/brunchlook.jpg" alt="Brunch Look" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Brunch Look</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Brunch</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Sunny & sweet üåû</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="party">
      <img src="/images/partywear.jpg" alt="Party Wear" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Party Wear</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Party</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Shine like a queen üëë</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="summer">
      <img src="/images/summerfit.jpg" alt="Summer Fit" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Summer Fit</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Summer</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Chic & breezy üçÉ</p>
      </div>
    </div>

    <div class="bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp" data-category="casual">
      <img src="/images/casualcombo.jpg" alt="Casual Combo" loading="lazy">
      <div class="p-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold text-lg text-pink-600">Casual Combo</h2>
          <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">Casual</span>
        </div>
        <p class="text-sm text-gray-500 mt-1">Laid-back & stylish üßã</p>
      </div>
    </div>

  </main>
  
  <!-- Lightbox Modal -->
  <div id="lightbox" class="fixed inset-0 bg-black/70 hidden items-center justify-center p-4 z-20">
    <div class="relative max-w-3xl w-full">
      <button id="closeLightbox" class="absolute -top-10 right-0 text-white text-2xl">‚úï</button>
      <img id="lightboxImg" src="" alt="Look" class="w-full rounded-lg shadow-xl">
      <div class="mt-3 text-center">
        <h3 id="lightboxTitle" class="text-white text-lg font-semibold"></h3>
        <p id="lightboxDesc" class="text-pink-100 text-sm mt-1"></p>
      </div>
    </div>
  </div>

  <!-- Back to top -->
  <button id="backToTop" class="hidden fixed bottom-6 right-6 z-20 rounded-full bg-pink-600 text-white w-11 h-11 shadow-lg hover:bg-pink-700">‚Üë</button>

  <!-- Upload Modal -->
  <div id="uploadModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center p-4 z-20">
    <div class="bg-white rounded-xl p-6 max-w-md w-full">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-semibold text-pink-600">Share Your Look</h3>
        <button id="closeUpload" class="text-gray-500 hover:text-gray-700">‚úï</button>
      </div>
      <form id="uploadForm" class="space-y-4" enctype="multipart/form-data">
        <input type="hidden" name="page" value="fashion">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Upload Photos</label>
          <input type="file" id="photoInput" name="photos" multiple accept="image/*" 
                 class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 
                        file:rounded-full file:border-0 file:text-sm file:font-semibold
                        file:bg-pink-50 file:text-pink-600
                        hover:file:bg-pink-100"/>
          <div id="previewContainer" class="mt-2 grid grid-cols-2 gap-2"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Look Title</label>
          <input type="text" name="title" required
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300"
                 placeholder="E.g., Summer Party Look">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
          <select name="category" required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300">
            <option value="date">Date Night</option>
            <option value="college">College</option>
            <option value="festive">Festive</option>
            <option value="street">Street</option>
            <option value="brunch">Brunch</option>
            <option value="party">Party</option>
            <option value="summer">Summer</option>
            <option value="casual">Casual</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
          <textarea name="description" rows="2" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300"
                    placeholder="Add a brief description of your look..."></textarea>
        </div>
        <button type="submit" 
                class="w-full py-2 px-4 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition duration-300">
          Share Look
        </button>
      </form>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Load saved uploads first
      async function loadSavedUploads() {
        try {
          const response = await fetch('/api/uploads?page=fashion');
          const data = await response.json();
          if (data.success && data.files) {
            const gallery = document.getElementById('gallery');
            
            // Add uploaded images to the gallery
            data.files.forEach(file => {
              const card = document.createElement('div');
              card.className = 'bg-white rounded-xl overflow-hidden shadow-md masonry-item animate__animated animate__fadeInUp';
              card.setAttribute('data-category', file.category || 'all');
              
              card.innerHTML = `
                <img src="${file.path}" alt="${file.title || 'Fashion Look'}" loading="lazy">
                <div class="p-3">
                  <div class="flex items-center justify-between">
                    <h2 class="font-semibold text-lg text-pink-600">${file.title || 'Fashion Look'}</h2>
                    <span class="text-xs px-2 py-0.5 rounded-full bg-pink-100 text-pink-700">${file.category || 'All'}</span>
                  </div>
                  <p class="text-sm text-gray-500 mt-1">${file.description || ''}</p>
                </div>
              `;
              
              gallery.insertBefore(card, gallery.firstChild);
            });
          }
        } catch (error) {
          console.error('Error loading saved uploads:', error);
        }
      }
      
      loadSavedUploads();
      
      const filterBar = document.getElementById('filterBar');
      const searchInput = document.getElementById('searchInput');
      const cards = Array.from(document.querySelectorAll('.masonry-item'));

      function applyFilters(activeCategory, searchTerm) {
        const q = (searchTerm || '').trim().toLowerCase();
        cards.forEach(card => {
          const category = card.getAttribute('data-category');
          const title = card.querySelector('h2')?.textContent.toLowerCase() || '';
          const desc = card.querySelector('p')?.textContent.toLowerCase() || '';
          const matchCategory = activeCategory === 'all' || activeCategory === category;
          const matchSearch = !q || title.includes(q) || desc.includes(q);
          card.style.display = matchCategory && matchSearch ? '' : 'none';
        });
      }

      // Filters
      let activeCategory = 'all';
      filterBar.addEventListener('click', (e) => {
        const btn = e.target.closest('button[data-filter]');
        if (!btn) return;
        activeCategory = btn.getAttribute('data-filter');
        // update button styles
        filterBar.querySelectorAll('button').forEach(b => {
          b.classList.remove('bg-pink-600','text-white');
          b.classList.add('bg-white','text-pink-600');
        });
        btn.classList.remove('bg-white','text-pink-600');
        btn.classList.add('bg-pink-600','text-white');
        applyFilters(activeCategory, searchInput.value);
      });

      // Search
      searchInput.addEventListener('input', () => {
        applyFilters(activeCategory, searchInput.value);
      });

      // Lightbox
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightboxImg');
      const lightboxTitle = document.getElementById('lightboxTitle');
      const lightboxDesc = document.getElementById('lightboxDesc');
      const closeLightbox = document.getElementById('closeLightbox');

      cards.forEach(card => {
        card.addEventListener('click', () => {
          const img = card.querySelector('img');
          const title = card.querySelector('h2')?.textContent || '';
          const desc = card.querySelector('p')?.textContent || '';
          lightboxImg.src = img.src;
          lightboxImg.alt = img.alt || title;
          lightboxTitle.textContent = title;
          lightboxDesc.textContent = desc;
          lightbox.classList.remove('hidden');
          lightbox.classList.add('flex');
        });
      });

      function hideLightbox() {
        lightbox.classList.add('hidden');
        lightbox.classList.remove('flex');
        // stop any potential background scroll jump
        document.activeElement?.blur?.();
      }
      closeLightbox.addEventListener('click', hideLightbox);
      lightbox.addEventListener('click', (e) => { if (e.target === lightbox) hideLightbox(); });
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') hideLightbox(); });

      // Back to top
      const backToTop = document.getElementById('backToTop');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTop.classList.remove('hidden');
        } else {
          backToTop.classList.add('hidden');
        }
      });
      backToTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

      // Upload Modal Functionality
      const uploadModal = document.getElementById('uploadModal');
      const openUpload = document.getElementById('openUpload');
      const closeUpload = document.getElementById('closeUpload');
      const uploadForm = document.getElementById('uploadForm');
      const photoInput = document.getElementById('photoInput');
      const previewContainer = document.getElementById('previewContainer');

      function showUploadModal() {
        uploadModal.classList.remove('hidden');
        uploadModal.classList.add('flex');
      }

      function hideUploadModal() {
        uploadModal.classList.add('hidden');
        uploadModal.classList.remove('flex');
        uploadForm.reset();
        previewContainer.innerHTML = '';
      }

      openUpload.addEventListener('click', showUploadModal);
      closeUpload.addEventListener('click', hideUploadModal);
      uploadModal.addEventListener('click', (e) => {
        if (e.target === uploadModal) hideUploadModal();
      });

      // Preview uploaded images
      photoInput.addEventListener('change', function() {
        previewContainer.innerHTML = '';
        const files = Array.from(this.files);
        files.forEach(file => {
          const reader = new FileReader();
          reader.onload = function(e) {
            const preview = document.createElement('div');
            preview.className = 'relative';
            preview.innerHTML = `
              <img src="${e.target.result}" class="w-full h-32 object-cover rounded-lg">
            `;
            previewContainer.appendChild(preview);
          }
          reader.readAsDataURL(file);
        });
      });

      // Handle form submission
      uploadForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        
        try {
          const response = await fetch('/upload', {
            method: 'POST',
            body: formData
          });
          
          if (response.ok) {
            alert('Your look has been shared successfully!');
            hideUploadModal();
            // Optionally reload the page to show the new upload
            window.location.reload();
          } else {
            alert('Failed to upload. Please try again.');
          }
        } catch (error) {
          console.error('Upload error:', error);
          alert('An error occurred while uploading. Please try again.');
        }
      });
    });
  </script>
</body>
</html>
